# 開発プラン

## 概要

このファイルで開発タスクの一覧と進捗を管理する。

**方針:**
- 機能単位でタスクを整理（技術スタック単位ではなく）
- 各Phaseで独立してE2Eテストが可能な粒度
- Jupyter関連を優先、カタログ機能は後日

## ステータス凡例

- `[ ]` 未着手
- `[→]` 進行中
- `[x]` 完了
- `[!]` ブロック中（理由をメモ）

---

## Phase 1: 基盤構築

### 1.1 jupyter-server 環境構築

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 1.1.1 | Dockerfile 作成 | [x] | - | ベースイメージ: jupyter/scipy-notebook |
| 1.1.2 | docker-compose.yml 作成 | [x] | - | |
| 1.1.3 | jupyter_server_config.py 作成 | [x] | - | トークン認証、CORS設定 |
| 1.1.4 | requirements.txt 作成 | [x] | - | pandas, matplotlib等 |
| 1.1.5 | ヘルスチェックスクリプト作成 | [x] | - | |
| 1.1.6 | 動作確認 | [x] | `docker-compose up` でJupyterLabにアクセス可能 | |

### 1.2 jupyter-mcp プロジェクト初期化

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 1.2.1 | package.json, tsconfig.json 作成 | [x] | - | |
| 1.2.2 | jupyter-client 実装 | [x] | jupyter-server APIと疎通確認 | REST APIクライアント基盤 |

---

## Phase 2: ノートブック基本操作

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 2.1 | notebook_create ツール実装 | [x] | MCPツールでノートブックファイルが作成される | |
| 2.2 | notebook_add_cell ツール実装 | [x] | MCPツールでセルが追加される | |
| 2.3 | 結合テスト | [x] | ノートブック作成→セル追加の一連フローが動作 | |

---

## Phase 3: セッション・カーネル管理

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 3.1 | session_create ツール実装 | [x] | MCPツールでセッション（カーネル）が起動する | |
| 3.2 | session_list ツール実装 | [x] | MCPツールでセッション一覧が取得できる | |
| 3.3 | session_delete ツール実装 | [x] | MCPツールでセッションが終了する | |
| 3.4 | 結合テスト | [ ] | セッション作成→一覧確認→削除の一連フローが動作 | |
| 3.5 | session_connect ツール実装 | [ ] | ブラウザで開いたセッションにMCPで接続できる | ユーザー先行パターン |
| 3.6 | session_create のnotebook_path対応 | [ ] | 指定したノートブックでセッション作成、ブラウザから接続可能 | AI先行パターン |

---

## Phase 4: コード実行

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 4.1 | execute_code ツール実装 | [ ] | MCPツールで `print("hello")` を実行し結果が返る | |
| 4.2 | エラーハンドリング実装 | [ ] | エラーコード実行時に適切なエラー情報が返る | |
| 4.3 | タイムアウト実装 | [ ] | 長時間実行コードがタイムアウトする | |
| 4.4 | 結合テスト | [ ] | ノートブック作成→セル追加→セッション作成→実行の一連フロー | |

---

## Phase 5: 変数管理

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 5.1 | get_variables ツール実装 | [ ] | MCPツールで定義済み変数一覧が取得できる | |
| 5.2 | get_dataframe_info ツール実装 | [ ] | MCPツールでDataFrameの詳細情報が取得できる | |
| 5.3 | 結合テスト | [ ] | コード実行→変数確認の一連フロー | |

---

## Phase 6: ファイル操作

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 6.1 | file_list ツール実装 | [ ] | MCPツールでワークスペース内ファイル一覧が取得できる | |
| 6.2 | 結合テスト | [ ] | ノートブック作成→file_listで確認 | |

---

## Phase 7: 画像リソース

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 7.1 | execute_code の画像出力対応 | [ ] | matplotlibグラフ実行時にimages配列が返る | |
| 7.2 | MCPリソース実装 | [ ] | リソースURIで画像一覧・取得が可能 | resources/list, resources/read |
| 7.3 | get_image_resource ツール実装 | [ ] | MCPツールで画像データ（base64）が取得できる | |
| 7.4 | 結合テスト | [ ] | グラフ描画→画像取得→内容確認の一連フロー | |

---

## Phase 8: Jupyter統合テスト

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 8.1 | 単体テスト整備 | [ ] | 全ツールのユニットテストが通る | |
| 8.2 | MCP Inspector での動作確認 | [ ] | 全ツールがInspectorで表示・実行可能 | |
| 8.3 | Claude Desktop での動作確認 | [ ] | Claude Desktopから接続して分析フロー実行可能 | |

---

## Phase 9: カタログ機能（後日）

| # | タスク | ステータス | 備考 |
|---|--------|-----------|------|
| 9.1 | document-server 実装 | [ ] | 詳細は後日計画 |
| 9.2 | document-mcp 実装 | [ ] | 詳細は後日計画 |
| 9.3 | 結合テスト | [ ] | |

---

## Phase 10: 全体統合

| # | タスク | ステータス | E2Eテスト | 備考 |
|---|--------|-----------|-----------|------|
| 10.1 | docker-compose 統合 | [ ] | 全コンポーネントが同時起動 | |
| 10.2 | E2Eテストシナリオ作成・実行 | [ ] | カタログ参照→分析実行の完全フロー | |
| 10.3 | パフォーマンス確認 | [ ] | 応答時間が要件を満たす | |
| 10.4 | ドキュメント最終整備 | [ ] | README等 | |

---

## 変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2026-02-01 | カーネル共有機能を追加（3.5, 3.6） |
| 2026-01-31 | 機能単位の構成に再編成（技術スタック単位から変更） |
| YYYY-MM-DD | 初版作成 |
