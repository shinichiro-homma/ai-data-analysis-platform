# タスク詳細: 1.1.2 docker-compose.yml 作成

## 概要

jupyter-server コンテナを管理するための docker-compose.yml を作成する。これにより、環境変数やボリュームマウントの設定を一元管理し、`docker-compose up -d` で簡単に開発環境を起動できるようにする。

## 関連ドキュメント

- 要件定義: `docs/requirements/jupyter-server.md`
  - 「技術仕様 > 環境変数」セクション
  - 「技術仕様 > ポート」セクション
  - 「NF4: 運用性」セクション

## 実装計画

### 作成するファイル

| ファイル | 内容 |
|----------|------|
| `jupyter-server/docker-compose.yml` | jupyter-server コンテナの定義 |
| `jupyter-server/.env.example` | 環境変数のテンプレート |

### 実装手順

1. `jupyter-server/docker-compose.yml` を作成
   - サービス名: `jupyter-server`
   - ビルドコンテキスト: カレントディレクトリ
   - ポートマッピング: 8888:8888
   - 環境変数の設定（デフォルト値付き）
   - ボリュームマウント: data, output, work ディレクトリ
   - 再起動ポリシー: unless-stopped

### 設定内容

#### 環境変数

| 変数名 | 設定方法 | デフォルト値 |
|--------|----------|-------------|
| `JUPYTER_TOKEN` | `.env` ファイルから取得 | （必須） |
| `KERNEL_TIMEOUT` | 固定値 | 1800 |
| `EXECUTION_TIMEOUT` | 固定値 | 30 |
| `MAX_OUTPUT_SIZE` | 固定値 | 1048576 |

#### .env ファイル

`.env.example` を作成し、必要な環境変数のテンプレートを提供する。

```
JUPYTER_TOKEN=your-secret-token-here
```

#### ボリューム

| ホスト | コンテナ | 用途 |
|--------|----------|------|
| `./data` | `/home/jovyan/data` | データファイル配置 |
| `./output` | `/home/jovyan/output` | 出力ファイル保存 |
| `./work` | `/home/jovyan/work` | 作業ディレクトリ |

### 技術的な考慮事項

- **環境変数の管理**: `JUPYTER_TOKEN` は `.env` ファイルから読み込む。`.env.example` をテンプレートとして提供
- **ボリュームの永続化**: 名前付きボリュームではなくバインドマウントを使用し、ホスト側からファイルアクセスを容易にする
- **ヘルスチェック**: タスク 1.1.5 で追加するため、この段階では省略
- **ネットワーク**: 今後の拡張（jupyter-mcp との通信）を考慮し、明示的なネットワーク定義は Phase 10 で行う

## 完了条件

- [x] `jupyter-server/docker-compose.yml` が作成されている
- [x] `jupyter-server/.env.example` が作成されている
- [x] `.env.example` をコピーして `.env` を作成後、`docker-compose config` でバリデーションエラーがない
- [x] `docker-compose build` が成功する

## テスト計画

1. `.env.example` をコピーして `.env` を作成し、トークン値を設定
2. `cd jupyter-server && docker-compose config` を実行し、設定が正しくパースされることを確認
3. `docker-compose build` を実行し、イメージがビルドされることを確認
4. （起動確認はタスク 1.1.6 で実施）

---

## レビューステータス

- [x] 計画レビュー完了
- [x] 実装完了
- [x] テスト完了
